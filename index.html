<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Converter</title>
    <style>
        body {
            background-color: #1a1a1a; /* Dark background color */
            color: #d3d3d3; /* Light text color */
            font-family: 'Courier New', monospace; /* Low-contrast font */
            max-width: 600px; /* Limit width for better readability */
            margin: 20px auto;
        }

        h2 {
            color: #ff9900; /* Accent color */
        }

        label {
            margin-top: 10px;
            display: block;
        }

        input, button {
            margin-top: 5px;
            padding: 8px;
            border: none;
            background-color: #404040; /* Input background color */
            color: #d3d3d3; /* Input text color */
            cursor: pointer;
        }

        button {
            background-color: #ff9900; /* Accent color for the button */
            color: #1a1a1a; /* Button text color */
        }
    </style>
</head>
<body>
     <h2>Select Your Image</h2>

    <!-- File selector for PNGs -->
    <input type="file" id="pngSelector">

    <!-- Input box for character width -->
    <label for="charWidth">Char Width:</label>
    <input type="number" id="charWidth" value="8">

    <!-- Input box for character height -->
    <label for="charHeight">Char Height:</label>
    <input type="number" id="charHeight" value="16">

    <!-- Button to generate OTF -->
    <button onclick="generateOTF()">Generate OTF</button>

   <script src="opentype.js"></script>
   <script>
        function generateOTF() {
            // Get selected PNG file
            const pngSelector = document.getElementById('pngSelector');
            const selectedFile = pngSelector.files[0];

            if (selectedFile) {
                const charWidth = parseInt(document.getElementById('charWidth').value);
                const charHeight = parseInt(document.getElementById('charHeight').value);

                const img = new Image();
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');

                const notdefGlyph = new opentype.Glyph({
                    name: '.notdef',
                    advanceWidth: 80,
                    path: new opentype.Path()
                });

                var glyphs = [notdefGlyph];
                const factor = 10;

                img.onload = function () {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    context.drawImage(img, 0, 0, img.width, img.height);

                    // Iterate through pixels
                    for (let y = 0; y < img.height; y += charHeight) {
                        for (let x = 0; x < img.width; x += charWidth) {
                            const pixelData = context.getImageData(x, y, charWidth, charHeight).data;

                          // Chunk pixel data into groups of four (assuming RGBA format)
                          const glyphPath = new opentype.Path();
                          for (let i = 0; i < pixelData.length; i += 4) {
                              const rgba = pixelData.slice(i, i + 4);

                              // Check if the pixel is white (assuming white is [255, 255, 255, 255])
                              const isWhite = rgba.every(value => value === 255);

                              const xmod = i % charWidth;
                              const ymod = Math.floor(i / charHeight);
                              if (isWhite) {
                                glyphPath.moveTo(xmod * factor, (charHeight - ymod) * factor);
                                glyphPath.lineTo((xmod + 1) * factor, (charHeight - ymod) * factor);
                                glyphPath.lineTo((xmod + 1) * factor, ((charHeight - ymod) - 1) * factor);
                                glyphPath.lineTo(xmod * factor, ((charHeight - ymod) - 1) * factor);
                                glyphPath.closePath();
                              }
                          }
                          const index = Math.floor(Math.floor(x / charWidth) + (Math.floor(y / charHeight) * (img.width / charWidth)));
                  if (index > 254) { continue;}
                          const customGlyph = new opentype.Glyph({
                            name: codePage437[index].name,
                            unicode: index + 1,
                            advanceWidth: 80, // Adjust as needed
                            path: glyphPath
                          });
                          glyphs.push(customGlyph);
                          
                        }
                    }
 
                const font = new opentype.Font({
                    familyName: 'hortau_noise',
                    styleName: 'Medium',
                    unitsPerEm: 100,
                    ascender: 160,
                    descender: 0,
                    glyphs: glyphs
                });
                
                font.download();

                };

                const reader = new FileReader();
                reader.onload = function (e) {
                    img.src = e.target.result;
                };

                reader.readAsDataURL(selectedFile);
            } else {
                alert('Please select an image file.');
            }
        }

const codePage437 = [
    {  name: 'Start of Heading' },
    {  name: 'Start of Text' },
    {  name: 'End of Text' },
    {  name: 'End of Transmission' },
    {  name: 'Enquiry' },
    {  name: 'Acknowledgment' },
    {  name: 'Bell' },
    {  name: 'Backspace' },
    {  name: 'Horizontal Tabulation' },
    { name: 'Line Feed' },
    { name: 'Vertical Tabulation' },
    { name: 'Form Feed' },
    { name: 'Carriage Return' },
    { name: 'Shift Out' },
    { name: 'Shift In' },
    { name: 'Data Link Escape' },
    { name: 'Device Control One' },
    { name: 'Device Control Two' },
    { name: 'Device Control Three' },
    { name: 'Device Control Four' },
    { name: 'Negative Acknowledgment' },
    { name: 'Synchronous Idle' },
    { name: 'End of Transmission Block' },
    { name: 'Cancel' },
    { name: 'End of Medium' },
    { name: 'Substitute' },
    { name: 'Escape' },
    { name: 'File Separator' },
    { name: 'Group Separator' },
    { name: 'Record Separator' },
    { name: 'Unit Separator' },
    { name: 'Space' },
    { name: 'Exclamation Mark' },
    { name: 'Quotation Mark' },
    { name: 'Number Sign' },
    { name: 'Dollar Sign' },
    { name: 'Percent Sign' },
    { name: 'Ampersand' },
    { name: 'Apostrophe' },
    { name: 'Left Parenthesis' },
    { name: 'Right Parenthesis' },
    { name: 'Asterisk' },
    { name: 'Plus Sign' },
    { name: 'Comma' },
    { name: 'Hyphen-Minus' },
    { name: 'Full Stop' },
    { name: 'Solidus' },
    { name: 'Digit Zero' },
    { name: 'Digit One' },
    { name: 'Digit Two' },
    { name: 'Digit Three' },
    { name: 'Digit Four' },
    { name: 'Digit Five' },
    { name: 'Digit Six' },
    { name: 'Digit Seven' },
    { name: 'Digit Eight' },
    { name: 'Digit Nine' },
    { name: 'Colon' },
    { name: 'Semicolon' },
    { name: 'Less-Than Sign' },
    { name: 'Equals Sign' },
    { name: 'Greater-Than Sign' },
    { name: 'Question Mark' },
    { name: 'Commercial At' },
    { name: 'Latin Capital Letter A' },
    { name: 'Latin Capital Letter B' },
    { name: 'Latin Capital Letter C' },
    { name: 'Latin Capital Letter D' },
    { name: 'Latin Capital Letter E' },
    { name: 'Latin Capital Letter F' },
    { name: 'Latin Capital Letter G' },
    { name: 'Latin Capital Letter H' },
    { name: 'Latin Capital Letter I' },
    { name: 'Latin Capital Letter J' },
    { name: 'Latin Capital Letter K' },
    { name: 'Latin Capital Letter L' },
    { name: 'Latin Capital Letter M' },
    { name: 'Latin Capital Letter N' },
    { name: 'Latin Capital Letter O' },
    { name: 'Latin Capital Letter P' },
    { name: 'Latin Capital Letter Q' },
    { name: 'Latin Capital Letter R' },
    { name: 'Latin Capital Letter S' },
    { name: 'Latin Capital Letter T' },
    { name: 'Latin Capital Letter U' },
    { name: 'Latin Capital Letter V' },
    { name: 'Latin Capital Letter W' },
    { name: 'Latin Capital Letter X' },
    { name: 'Latin Capital Letter Y' },
    { name: 'Latin Capital Letter Z' },
    { name: 'Left Square Bracket' },
    { name: 'Reverse Solidus' },
    { name: 'Right Square Bracket' },
    { name: 'Caret' },
    { name: 'Low Line' },
    { name: 'Grave Accent' },
    { name: 'Latin Small Letter A' },
    { name: 'Latin Small Letter B' },
    { name: 'Latin Small Letter C' },
    {  name: 'Latin Small Letter D' },
    {  name: 'Latin Small Letter E' },
    {  name: 'Latin Small Letter F' },
    {  name: 'Latin Small Letter G' },
    {  name: 'Latin Small Letter H' },
    {  name: 'Latin Small Letter I' },
    {  name: 'Latin Small Letter J' },
    {  name: 'Latin Small Letter K' },
    {  name: 'Latin Small Letter L' },
    {  name: 'Latin Small Letter M' },
    {  name: 'Latin Small Letter N' },
    {  name: 'Latin Small Letter O' },
    {  name: 'Latin Small Letter P' },
    {  name: 'Latin Small Letter Q' },
    {  name: 'Latin Small Letter R' },
    {  name: 'Latin Small Letter S' },
    {  name: 'Latin Small Letter T' },
    {  name: 'Latin Small Letter U' },
    {  name: 'Latin Small Letter V' },
    {  name: 'Latin Small Letter W' },
    {  name: 'Latin Small Letter X' },
    {  name: 'Latin Small Letter Y' },
    {  name: 'Latin Small Letter Z' },
    {  name: 'Left Curly Bracket' },
    {  name: 'Vertical Line' },
    {  name: 'Right Curly Bracket' },
    {  name: 'Tilde' },
    {  name: 'Delete' },
    {  name: 'Ç' },
    {  name: 'ü' },
    {  name: 'é' },
    {  name: 'â' },
    {  name: 'ä' },
    {  name: 'à' },
    {  name: 'å' },
    {  name: 'ç' },
    {  name: 'ê' },
    {  name: 'ë' },
    {  name: 'è' },
    {  name: 'ï' },
    {  name: 'î' },
    {  name: 'ì' },
    {  name: 'Ä' },
    {  name: 'Å' },
    {  name: 'É' },
    {  name: 'æ' },
    {  name: 'Æ' },
    {  name: 'ô' },
    {  name: 'ö' },
    {  name: 'ò' },
    {  name: 'û' },
    {  name: 'ù' },
    {  name: 'ÿ' },
    {  name: 'Ö' },
    {  name: 'Ü' },
    {  name: '¢' },
    {  name: '£' },
    {  name: '¥' },
    {  name: '₧' },
    {  name: 'ƒ' },
    {  name: 'á' },
    {  name: 'í' },
    {  name: 'ó' },
    {  name: 'ú' },
    {  name: 'ñ' },
    {  name: 'Ñ' },
    {  name: 'ª' },
    {  name: 'º' },
    {  name: '¿' },
    {  name: '⌐' },
    {  name: '¬' },
    {  name: '½' },
    {  name: '¼' },
    {  name: '¡' },
    {  name: '«' },
    {  name: '»' },
    {  name: '░' },
    {  name: '▒' },
    {  name: '▓' },
    {  name: '│' },
    {  name: '┤' },
    {  name: '╡' },
    {  name: '╢' },
    {  name: '╖' },
    {  name: '╕' },
    {  name: '╣' },
    {  name: '║' },
    {  name: '╗' },
    {  name: '╝' },
    {  name: '╜' },
    {  name: '╛' },
    {  name: '┐' },
    {  name: '└' },
    {  name: '┴' },
    {  name: '┬' },
    {  name: '├' },
    {  name: '─' },
    {  name: '┼' },
    {  name: '╞' },
    {  name: '╟' },
    {  name: '╚' },
    {  name: '╔' },
    {  name: '╩' },
    {  name: '╦' },
    {  name: '╠' },
    {  name: '═' },
    {  name: '╬' },
    {  name: '╧' },
    {  name: '╨' },
    {  name: '╤' },
    {  name: '╥' },
    {  name: '╙' },
    {  name: '╘' },
    {  name: '╒' },
    {  name: '╓' },
    {  name: '╫' },
    {  name: '╪' },
    {  name: '┘' },
    {  name: '┌' },
    {  name: '█' },
    {  name: '▄' },
    {  name: '▌' },
    {  name: '▐' },
    {  name: '▀' },
    {  name: 'α' },
    {  name: 'ß' },
    {  name: 'Γ' },
    {  name: 'π' },
    {  name: 'Σ' },
    {  name: 'σ' },
    {  name: 'µ' },
    {  name: 'τ' },
    {  name: 'Φ' },
    {  name: 'Θ' },
    {  name: 'Ω' },
    {  name: 'δ' },
    {  name: '∞' },
    {  name: 'φ' },
    {  name: 'ε' },
    {  name: '∩' },
    {  name: '≡' },
    {  name: '±' },
    {  name: '≥' },
    {  name: '≤' },
    {  name: '⌠' },
    {  name: '⌡' },
    {  name: '÷' },
    {  name: '≈' },
    {  name: '°' },
    {  name: '∙' },
    {  name: '·' },
    {  name: '√' },
    {  name: 'ⁿ' },
    {  name: '²' },
    {  name: '■' },
    {  name: 'Non-Breaking Space' }
];
    </script>

</body>
</html>
